{% extends "template.html" %}
{% block content %}
<script>
    $(document).ready(function() {
            
            $('#link').click(function() {
                create();
                
            });
        });

        let currentSortOrder = 1; // 1 for ascending, 2 for descending

        function sortTable(attribute) {
            const sortOrder = currentSortOrder;
            currentSortOrder = (currentSortOrder === 1) ? 2 : 1;

            const metodo = $('#metodo').find(":selected").val();
            tabla("http://localhost:5000/clientes/"+sortOrder+"/"+attribute+"/"+metodo);
        }

        function tabla(url) {
            $.ajax({
                method: "GET",
                url: url,
                contentType: "json",
                success: function(data){
                    //console.log(data);
                    if(data.code == '200'){
                        var html = '';
                            $.each(data.data, function(i, info){
                                console.log(info);
                                html += '<tr>';
                                html += '<td>' + (i+1) + '</td>';
                                html += '<td>' + info.apellido + " " + info.nombre + '</td>';
                                html += '<td>' + info.dni + '</td>';
                                html += '<td>' + info.direccion + '</td>';
                                html += '<td>' + info.telefono + '</td>';
                                html += '<td>' + info.tiempoAtencion + '</td>';
                                html += '<td>' + info.calificarServicio + '</td>';
                                html += '<td>'+ '<a href="/clientes/editar/'+info.id +'" class="btn btn-warning">Editar</a>'+ '</td>';
                            });
                            html += '</tr>';

                        
                        $('#tabla tbody').html(html);
                    }
                }
            });
        }

        function create(){
            var aux = $('#tipo').prop('checked');
            var select = $('#criterio').find(":selected").val();
            var select2 = $('#metodo').find(":selected").val();
            if (aux) {
                tabla("http://localhost:5000/clientes/1/"+select+"/"+select2);
                
            } else {
                tabla("http://localhost:5000/clientes/2/"+select+"/"+select2);
            }
        }
        /* function create() {
            var aux = $('#tipo').prop('checked') ? 2 : 1;
            var select = $('#criterio').find(":selected").val();
            var select2 = $('#metodo').find(":selected").val() === 'QuickSort' ? 1 : ($('#metodo').find(":selected").val() === 'MergeSort' ? 2 : 3);
            tabla("http://localhost:5000/clientes/" + aux + "/" + select + "/" + select2);
        } */


</script>

<div class="booking-form-body p-4">
    
    <h3 class="text-white ">Lista de clientes</h3>
    <select id="metodo" class="btn-group " role="group" aria-label="Basic example">
        <option value="1" >QuickSort</option>
        <option value="2" >MergeSort</option>
        <option value="3" >ShellSort</option>
    </select>
    <a href="/clientes/ver" class="btn btn-danger" >Agregar cliente</a>
    <!-- <button id="link" class="btn btn-danger" >ORDENAR</button> -->
</div>

    <!-- <div class="accordion" id="accordionExample">
        <div class="accordion-item">
          <h2 class="accordion-header">
            <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
              Ordenar y agregar Clientes
            </button>
          </h2>
          <div id="collapseOne" class="accordion-collapse collapse show" data-bs-parent="#accordionExample">
            <div class="accordion-body">
                <div class="d-grid gap-2 mx-auto p-4 " >
                    <div class="form-check form-switch align-items-center">
                        <input class="form-check-input" value="DESCENDENTE" type="checkbox" role="switch" id="tipo">Orden Descendente
                        
                        
                    </div>
                    <div class="col">
                        <select id="criterio" class="form-select" aria-label="Default select example">
                            <option value="_nombre">Nombre</option>
                            <option value="_apellido">Apellido</option>
                            <option value="_dni">DNI</option>
                            <option value="_direccion">Direccion</option>
                            <option value="_telefono">Telefono</option>
                            <option value="_TiempoAtencion">Tiempo de atencion</option>
                            <option value="_CalificarServicio">Calificacion de servicio</option>
                        </select>
                    </div>
                    
                    <div class="col">
                        <select name="orden" class="from-select" aria-label="Default select example">
                            <option value="1">Ascendente</option>
                            <option value="2">Descendente</option>
                        </select>
                    </div>
                    <div class="col">
                        
                        <select name="Metodo"class="from-select" aria-label="Default select example">
                            <option value="1">QuickSort</option>
                            <option value="2">MergeSort</option>
                            <option value="3">ShellSort</option>
                        </select> 
                    </div>
                </div>

            </div>
          </div>
        </div>

        <div class="accordion-item">
          <h2 class="accordion-header">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
              Busqueda de clientes
            </button>
          </h2>
          <div id="collapseTwo" class="accordion-collapse collapse" data-bs-parent="#accordionExample">
            <div class="accordion-body">
                <p>Busqueda de clientes</p>
            </div>
          </div>
        </div>
      </div> -->

    <br>
    <br>
<div class="p-4">
    <table id="tabla" class="table table-dark table-hover" >
        <thead>
            <tr>
                <th title="Click para ordenar por el atributo" style="cursor: pointer" class="text-bg-warning" onclick="sortTable('_id')" >Nro </th>
                <th title="Click para ordenar por el atributo" style="cursor: pointer" class="text-bg-warning" onclick="sortTable('_apellido')">Cliente</th>
                <th title="Click para ordenar por el atributo" style="cursor: pointer" class="text-bg-warning" onclick="sortTable('_dni')">DNI</th>
                <th title="Click para ordenar por el atributo" style="cursor: pointer" class="text-bg-warning" onclick="sortTable('_direccion')">Direccion</th>
                <th title="Click para ordenar por el atributo" style="cursor: pointer" class="text-bg-warning" onclick="sortTable('_telefono')">Telefono</th>
                <th title="Click para ordenar por el atributo" style="cursor: pointer" class="text-bg-warning" onclick="sortTable('_TiempoAtencion')">Tiempo de atencion HH:MM</th>
                <th title="Click para ordenar por el atributo" style="cursor: pointer" class="text-bg-warning" onclick="sortTable('_CalificarServicio')">Calificacion de servicio</th>
                <th class="text-bg-warning" >Acciones</th>
            </tr>
        </thead>
        <tbody>
            {% for item in lista %}
                <tr>
                    <td>{{ item.id }}</td>
                    <td>{{ item.apellido }} {{ item.nombre }}</td>
                    <td>{{ item.dni }}</td>
                    <td>{{ item.direccion }}</td>
                    <td>{{ item.telefono }}</td>
                    <td>{{ item.tiempoAtencion }}</td>
                    <td>{{ item.calificarServicio }}</td>
                    <td>
                        <a href="/clientes/editar/{{ item.id }}" class="btn btn-warning">Editar</a>
                    </td>
                </tr>
            {% endfor%}
        </tbody>
    </table>
</div>
<script>

</script>
{% endblock %}